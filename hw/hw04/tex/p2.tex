\begin{problem}\label{prob:02}%%
  Exercise~6.4 in Nocedal and Wright.
  
  Show that
  
  \[ B_{k+1} = B_{k} + \frac{(y_k-B_{k}s_{k})(y_k-B_{k}s_{k})\transpose}{(y_k-B_{k}s_{k})\transpose s_k} \]
  
  is the inverse of 
   
  \[ H_{k+1} = H_k + \frac{(s_k-H_{k}y_{k})(s_k-H_{k}y_{k})\transpose}{(s_k-H_{k}y_{k})\transpose y_k} \text{.}\]
  
  \textbf{Note}: \textnormal{By the \textbf{Sherman-Morrison-Woodbury formula}, if the square nonsingular matrix $A$ undergoes a rank-one update to become}
  
  \[\bar{A} = A + ab\transpose\]
  
  \textnormal{where $a,b\in \mathbb{R}^n$, then if $\bar{A}$ is nonsingular, we have:}
  
  \[\bar{A}^{-1} = A^{-1} - \frac{A^{-1}ab\transpose A^{-1}}{1+b\transpose A^{-1}a} \text{.} \]
\end{problem}

By definition $H_k = B_k^{-1}$. Define $a = b = y_k - B_k s_k$ and $\rho = \frac{1}{(y_k-B_{k}s_{k})\transpose s_k}$.  Substituting

\[ B_{k+1} = B_k + \rho ab\transpose \text{.}\]

\noindent
This can be substituted into the Sherman-Morrison-Woodbury formula as:

\begin{aligncustom}
  B_{k+1}^{-1} &= B_k^{-1} - \frac{B_{k}^{-1} \rho (y_k - B_k s_k) (y_k - B_k s_k)\transpose B_{k}^{-1}}{1 + (y_k - B_k s_k)\transpose B_k^{-1} \rho(y_k - B_k s_k)}
\end{aligncustom}
  
\noindent
$B_k$ is a symmetric, nonsingular matrix.  As such, $B_{k}^{-1}$ is also a symmetric, nonsingular matrix.  Therefore,

\begin{aligncustom}
  B_{k+1}^{-1} &= B_k^{-1} - \frac{(B_{k}^{-1} y_k - s_k) (B_{k}^{-1} y_k - s_k)\transpose }{(y_k-B_{k}s_{k})\transpose s_k + (y_k - B_k s_k)\transpose (B_k^{-1} y_k - s_k)} \\
               &= B_k^{-1} - \frac{(s_k - B_{k}^{-1} y_k) (s_k - B_{k}^{-1} y_k)\transpose }{y_k\transpose s_k - (B_{k}s_{k})\transpose s_k + y_k\transpose B_k^{-1}y_k - y_k\transpose s_k - s_k\transpose y_k + (B_{k}s_k)\transpose s_k} \\
               &= B_k^{-1} - \frac{(s_k - B_{k}^{-1} y_k) (s_k - B_{k}^{-1} y_k)\transpose }{ y_k\transpose B_k^{-1}y_k - s_k\transpose y_k } \\
               &= B_k^{-1} - \frac{(s_k - B_{k}^{-1} y_k) (s_k - B_{k}^{-1} y_k)\transpose }{ (B_k^{-1}y_k - s_k)\transpose y_k } \\
               &= B_k^{-1} + \frac{(s_k - B_{k}^{-1} y_k) (s_k - B_{k}^{-1} y_k)\transpose }{ (s_k - B_k^{-1}y_k)\transpose y_k }
\end{aligncustom}

\noindent
By definition $B_{k}^{-1} = H_k$.  Therefore

\[ H_{k+1} = H_k + \frac{(s_{k} - H_{k} y_{k}) (s_{k} - H_{k} y_{k})\transpose }{ (s_{k} - H_{k} y_{k})\transpose y_{k}} \]
